# В этом файле собраны задания и ответы, которые реализуют:

**-выборку уникальных элементов столбца;**

**-выборку данных (групповые функции sum и count);**

**-выборку данных (групповые функции min, max и avg);**

**-выборку данных с вычислением (групповые функции);**

**-вычисления по таблице целиком;**

**-выборку данных по условию (групповые функции)**

**выборка данных по условию (групповые функции WHERE и HAVING).**

## Задание №1
Отобрать различные (уникальные) элементы столбца `amount` таблицы `book`.

### Решение для задания №1
```
SELECT 
  amount 
FROM 
  book 
GROUP BY 
  amount;
```
![image](https://github.com/00Julie00/SQL/assets/115406267/e9f56e9b-46d3-4ed7-8af9-155261355b18)

## Задание №2
Посчитать, количество различных книг и количество экземпляров книг каждого автора , хранящихся на складе.  
Столбцы назвать **Автор**, **Различных_книг** и **Количество_экземпляров** соответственно.

### Решение для задания №2
```
SELECT 
  author AS Автор, 
  COUNT(author) AS Различных_книг, 
  SUM(amount) AS Количество_экземпляров 
FROM 
  book 
GROUP BY 
  author;
```
![image](https://github.com/00Julie00/SQL/assets/115406267/319146c7-62f8-472e-9e07-9d975adc126d)


## Задание №3

Вывести фамилию и инициалы автора, минимальную, максимальную и среднюю цену книг каждого автора . 
Вычисляемые столбцы назвать **Минимальная_цена**, **Максимальная_цена** и **Средняя_цена** соответственно.

### Решение для задания №3
```
SELECT 
  author, 
  MIN(price) AS Минимальная_цена, 
  MAX(price) AS Максимальная_цена, 
  AVG(price) AS Средняя_цена 
FROM 
  book 
GROUP BY 
  author;
```
![image](https://github.com/00Julie00/SQL/assets/115406267/0c4bef95-2f05-41d7-ac33-a50f520f97ae)

## Задание №4

Для каждого автора вычислить суммарную стоимость книг **S** (имя столбца **Стоимость**), а также вычислить налог на добавленную стоимость  для полученных сумм (имя столбца **НДС** ) , который **включен в стоимость** и составляет 18% (**k=18**),  а также стоимость книг  (**Стоимость_без_НДС**) без него. Значения округлить до двух знаков после запятой. В запросе для расчета НДС(**tax**)  и Стоимости без НДС(**S_without_tax**) использовать следующие формулы:

![image](https://github.com/00Julie00/SQL/assets/115406267/9db1e8fd-42f1-4fb6-821f-ffcd40127397)

### Решение для задания №4
```
SELECT 
  author, 
  SUM(price * amount) AS Стоимость, 
  ROUND(
    SUM(price * amount) * (18 / 100) / (
      1 + (18 / 100)
    ), 
    2
  ) AS НДС, 
  ROUND(
    SUM(price * amount)/ (
      1 + (18 / 100)
    ), 
    2
  ) AS Стоимость_без_НДС 
FROM 
  book 
GROUP BY 
  author;
```
![image](https://github.com/00Julie00/SQL/assets/115406267/7d38a6f9-f4f1-4f49-96c2-f137431cbf19)

## Задание №5

Вывести  цену самой дешевой книги, цену самой дорогой и среднюю цену уникальных книг на складе. Названия столбцов **Минимальная_цена**, **Максимальная_цена**, **Средняя_цена** соответственно. 
Среднюю цену округлить до двух знаков после запятой.

**Пояснение:** В задании нужно посчитать среднюю цену уникальных книг на складе, а не среднюю цену всех экземпляров книг.

### Решение для задания №5
```
SELECT 
  ROUND(
    MIN(price), 
    2
  ) AS Минимальная_цена, 
  ROUND(
    MAX(price), 
    2
  ) AS Максимальная_цена, 
  ROUND(
    AVG(price), 
    2
  ) AS Средняя_цена 
FROM 
  book;
```
![image](https://github.com/00Julie00/SQL/assets/115406267/631fbc28-3a4a-4e2a-9207-c709d0c2e0bf)

## Задание №6
Вычислить среднюю цену и суммарную стоимость тех книг, количество экземпляров которых принадлежит интервалу от 5 до 14, включительно. 
Столбцы назвать **Средняя_цена** и **Стоимость**, значения округлить до 2-х знаков после запятой.

**Пояснение:** Если в запросе с групповыми функциями отсутствует `GROUP BY`, то для отбора записей используется ключевое слово `WHERE`.

### Решение для задания №6
```
SELECT 
  ROUND(
    AVG(price), 
    2
  ) AS Средняя_цена, 
  ROUND(
    SUM(price * amount), 
    2
  ) AS Стоимость 
FROM 
  book 
WHERE 
  amount BETWEEN 5 
  AND 14;
```
![image](https://github.com/00Julie00/SQL/assets/115406267/fca97e70-7a26-4422-8bd7-dfa34ba36b3c)

## Задание №7
Посчитать стоимость всех экземпляров каждого автора без учета книг «Идиот» и «Белая гвардия». В результат включить только тех авторов, у которых суммарная стоимость книг (без учета книг «Идиот» и «Белая гвардия») более 5000 руб. Вычисляемый столбец назвать **Стоимость**. Результат отсортировать по убыванию стоимости.

### Решение для задания №7
```
SELECT 
  author, 
  SUM(price * amount) AS Стоимость 
FROM 
  book 
WHERE 
  title <> 'Белая гвардия' 
  AND title <> 'Идиот' 
GROUP BY 
  author 
HAVING 
  SUM(price * amount) > 5000 
ORDER BY 
  Стоимость DESC;
```
![image](https://github.com/00Julie00/SQL/assets/115406267/eb111ad6-d1af-47a3-8bb0-b94bef582392)

## Задание №8
Придумайте один или несколько запросов к нашей таблице `book`, используя групповые функции. Проверьте, правильно ли они работают.

![image](https://github.com/00Julie00/SQL/assets/115406267/d1bd3834-dca1-402d-8b0d-8c7902f96941)






